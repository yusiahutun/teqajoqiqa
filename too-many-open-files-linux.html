<!doctype html><html class=no-js lang=en><head><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><meta http-equiv=x-ua-compatible content="IE=edge"><title>How to Solve the &amp;quot;Too Many Open Files&amp;quot; Error on Linux - ZingX</title><script>(function(e,t){e[t]=e[t].replace("no-js","js")})(document.documentElement,"className")</script><meta name=description content="If you see the &amp;quot;Too many files open&amp;quot; error message in Linux, your process has hit the upper limit of files it's allowed to open, usually 1,024. You can temporarily increase the limit to, for example, 2,048 files, with the command &amp;quot;ulimit -n 2048&amp;quot;. Increase the limit permanently by editing systemd configuration files."><meta name=robots content="index,follow,noarchive"><meta property="og:title" content="How to Solve the &amp;quot;Too Many Open Files&amp;quot; Error on Linux"><meta property="og:description" content="If you see the &amp;quot;Too many files open&amp;quot; error message in Linux, your process has hit the upper limit of files it's allowed to open, usually 1,024. You can temporarily increase the limit to, for example, 2,048 files, with the command &amp;quot;ulimit -n 2048&amp;quot;. Increase the limit permanently by editing systemd configuration files."><meta property="og:type" content="article"><meta property="og:url" content="/too-many-open-files-linux.html"><meta property="article:section" content="post"><meta property="article:published_time" content="2024-09-10T00:00:00+00:00"><meta property="article:modified_time" content="2024-09-10T00:00:00+00:00"><meta itemprop=name content="How to Solve the &amp;quot;Too Many Open Files&amp;quot; Error on Linux"><meta itemprop=description content="If you see the &amp;quot;Too many files open&amp;quot; error message in Linux, your process has hit the upper limit of files it's allowed to open, usually 1,024. You can temporarily increase the limit to, for example, 2,048 files, with the command &amp;quot;ulimit -n 2048&amp;quot;. Increase the limit permanently by editing systemd configuration files."><meta itemprop=datePublished content="2024-09-10T00:00:00+00:00"><meta itemprop=dateModified content="2024-09-10T00:00:00+00:00"><meta itemprop=wordCount content="1678"><meta itemprop=keywords content><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=dns-prefetch href=//fonts.googleapis.com><link rel=dns-prefetch href=//fonts.gstatic.com><link rel=stylesheet href="https://fonts.googleapis.com/css?family=Open+Sans:400,400i,700"><link rel=stylesheet href=https://assets.cdnweb.info/hugo/mainroad/css/style.css><link rel="shortcut icon" href=./favicon.ico></head><body class=body><div class="container container--outer"><header class=header><div class="container header__container"><div class=logo><a class=logo__link href=./index.html title=ZingX rel=home><div class="logo__item logo__text"><div class=logo__title>ZingX</div></div></a></div><div class=divider></div></div></header><div class="wrapper flex"><div class=primary><main class=main role=main><article class=post><header class=post__header><h1 class=post__title>How to Solve the &amp;quot;Too Many Open Files&amp;quot; Error on Linux</h1><div class="post__meta meta"><div class="meta__item-datetime meta__item"><svg class="meta__icon icon icon-time" width="16" height="14" viewBox="0 0 30 28"><path d="M15 0C7 0 1 6 1 14s6 14 14 14 14-6 14-14S23 0 15 0zm0 25C9 25 4 20 4 14S9 3 15 3s11 5 11 11-5 11-11 11zm1-18h-2v8.4l6.8 4.4L22 18l-6-3.8V7z"/></svg><time class=meta__text datetime=2024-09-10T00:00:00Z>September 10, 2024</time></div><div class="meta__item-categories meta__item"><svg class="meta__icon icon icon-category" width="16" height="16" viewBox="0 0 16 16"><path d="m7 2 1 2h8v11H0V2z"/></svg><span class=meta__text><a class=meta__link href=./categories/blog/ rel=category>blog</a></span></div></div></header><div class="content post__content clearfix"><h3>Quick Links</h3><ul class=table-content-level-1><li><a href=#>What Is the Too Many Open Files Error?</a></li></ul><ul class=table-content-level-1><li><a href=#>Why Are So Many Files Opening?</a></li></ul><ul class=table-content-level-1><li><a href=#>How to Check File Handle Limits</a></li></ul><ul class=table-content-level-1><li><a href=#>How to Increase the Soft Limit</a></li></ul><ul class=table-content-level-1><li><a href=#>How to Permanently Change the File Limit</a></li></ul><ul class=table-content-level-1><li><a href=#>Remember That Everything is a File</a></li></ul><h3 class="title icon i-list">Key Takeaways</h3><p>If you see the "Too many files open" error message in Linux, your process has hit the upper limit of files it's allowed to open, usually 1,024. You can temporarily increase the limit to, for example, 2,048 files, with the command "ulimit -n 2048". Increase the limit permanently by editing systemd configuration files.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>On Linux computers, system resources are shared amongst the users. Try to use more than your fair share and you'll hit an upper limit. You might also bottleneck other users or processes.</p><h2 id=what-is-the-too-many-open-files-error>What Is the Too Many Open Files Error?</h2><p>Amongst its other gazillion jobs, <a href=#>the kernel of a Linux computer</a> is always busy watching who's using how many of the finite system resources, such as <a href=#>RAM</a> and <a href=#>CPU cycles</a>. A <a href=#>multi-user system</a> requires constant attention to make sure people and processes aren't using more of any given system resource than is appropriate.</p><p>It's not fair, for example, for someone to hog so much CPU time that the computer feels slow for everyone else. Even if you're the only person who uses your Linux computer, there are limits set for the resources your processes can use. After all, you're still just another user.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Some system resources are well-known and obvious, like RAM, CPU cycles, and hard drive space. But there are many, many more resources that are monitored and for which each user — or each user-owned process — has a set upper limit. One of these is the number of <a href=#>files</a> a process can have open at once.</p><p>If you've ever seen the "Too many files open" error message in a terminal window or found it in your system logs, it means that the upper limit has been hit, and the process is not being permitted to open any more files.</p><h2 id=why-are-so-many-files-opening>Why Are So Many Files Opening?</h2><p>There's a system-wide limit to the number of open files that Linux can handle. It's a very large number, as we'll see, but there is still a limit. Each user process has an allocation that they can use. They each get a small share of the system total allocated to them.</p><p>What actually gets allocated is a number of file handles. Each file that is opened requires a handle. Even with fairly generous allocations, system-wide, file handles can get used up faster than you might first imagine.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Linux abstracts almost everything so that it <a href=#>appears as though it is a file</a>. Sometimes they'll be just that, plain old files. But other actions such as opening a directory uses a file handle too. Linux uses block special files as a sort of driver for hardware devices. Character special files are very similar, but they are more often used with devices that have a concept of throughput, such as <a href=#>pipes</a> and serial ports.</p><p>Block special files handle blocks of data at a time and character special files handle each character separately. Both of these special files can only be accessed by using file handles. Libraries used by a program use a file handle, streams use file handles, and network connections use file handles.</p><p>Abstracting all of these different requirements so that they appear as files simplifies interfacing with them and allows such things as piping and streams to work.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>You can see that behind the scenes Linux is opening files and using file handles just to run itself — never mind your user <a href=#>processes</a>. The count of open files isn't just the number of files you've opened. Almost everything in the operating system is using file handles.</p><h2 id=how-to-check-file-handle-limits>How to Check File Handle Limits</h2><p>The system-wide maximum number of file handles can be seen with this command.</p><pre>cat /proc/sys/fs/file-max</pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2022/05/1-4.png><p>This returns a preposterously large number of 9.2 quintillion. That's the theoretical system maximum. It's the largest possible value you can hold in a <a href=#>64-bit</a> signed integer. Whether your poor computer could actually cope with that many files open at once is another matter altogether.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>At the user level, there isn't an explicit value for the maximum number of open files you can have. But we can roughly work it out. To find out the maximum number of files that one of your processes can open, we can use the <code>ulimit</code> command with the <code>-n</code> (open files) option.</p><pre>ulimit -n</pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2022/05/2-5.png><p>And to find the maximum number of processes a user can have we'll use <code>ulimit</code> with the <code>-u</code> (user processes) option.</p><pre>ulimit -u</pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2022/05/3-4.png> <strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Multiplying 1024 and 7640 gives us 7,823,360. Of course, many of those processes will be already used by your desktop environment and other background processes. So that's another theoretical maximum, and one you'll never realistically achieve.</p><p>The important figure is the number of files a process can open. By default, this is 1024. It's worth noting that opening the same file 1024 times concurrently is the same as opening 1024 different files concurrently. Once you've used up all of your file handles, you're done.</p><p>It's possible to adjust the number of files a process can open. There are actually two values to consider when you're adjusting this number. One is the value it is currently set to, or that you're trying to set it to. This is called the soft limit. There's a hard limit too, and this is the highest value that you can raise the soft limit to.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>The way to think about this is the soft limit really is the "current value" and the upper limit is the highest value the current value can reach. A regular, non-root, user can raise their soft limit to any value up to their hard limit. The root user can increase their hard limit.</p><p>To see the current soft and hard limits, use <code>ulimit</code> with the <code>-S</code> (soft) and <code>-H</code> (hard) options, and the <code>-n</code> (open files) option.</p><pre>ulimit -Sn</pre><pre>ulimit -Hn</pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2022/05/4-4.png><p>To create a situation where we can see the soft limit being enforced, we <a href=#>created a program</a> that repeatedly opens files until it fails. It then waits for a keystroke before relinquishing all the file handles it used. The program is called <code>open-files</code>.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><pre>./open-Files</pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2022/05/5-4.png><p>It opens 1021 files and fails as it tries to open file 1022.</p><p>1024 minus 1021 is 3. What happened to the other three file handles? They were used for <a href=#>the <code>STDIN</code>, <code>STDOUT</code>, and <code>STDERR</code> streams</a>. They're created automatically for each process. These always have file descriptor values of 0, 1, and 2.</p><p>We can see these using <a href=#>the <code>lsof</code> command</a> with the <code>-p</code> (process) option and the <a href=#>process ID</a> of the <code>open-files</code>program. Handily, it prints its process ID to the terminal window.</p><pre>lsof -p 11038</pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2022/05/6-4.png> <strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Of course, In a real-world situation, you might not know which process has just gobbled up all the file handles. To start your investigation you could use this sequence of piped commands. It'll tell you the fifteen most prolific users of file handles on your computer.</p><pre>lsof | awk '{ print $1 " " $2; }' | sort -rn | uniq -c | sort -rn | head -15</pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2022/05/9-4.png><p>To see more or fewer entries adjust the <code>-15</code> parameter to the <code>head</code> command. Once you've identified the process, you need to figure out whether it has gone rogue and is opening too many files because it is out of control, or whether it really needs those files. If it does need them, you need to increase its file handle limit.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><h2 id=how-to-increase-the-soft-limit>How to Increase the Soft Limit</h2><p>If we increase the soft limit and run our program again, we should see it open more files. We'll use the <code>ulimit</code> command and the <code>-n</code> (open files) option with a numeric value of 2048. This will be the new soft limit.</p><pre>ulimit -n 2048</pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2022/05/7-4.png><p>This time we successfully opened 2045 files. As expected, this is three less than 2048, because of the file handles used for <code>STDIN</code> , <code>STDOUT</code> , and <code>STDERR</code>.</p><h2 id=how-to-permanently-change-the-file-limit>How to Permanently Change the File Limit</h2><p>Increasing the soft limit only affects the current shell. <a href=#>Open a new terminal window</a> and check the soft limit. You'll see it is the old default value. But there is a way to globally set a new default value for the maximum number of open files a process can have that is persistent and survives <a href=#>reboots</a>.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Out-dated advice often recommends you edit files such as "/etc/sysctl.conf" and "/etc/security/limits.conf." However, on <a href=#>systemd</a>-based distributions, these edits don't work consistently, especially for graphical log-in sessions.</p><p>The technique shown here is the way to do this on systemd-based distributions. There are two files we need to work with. The first is the "/etc/systemd/system.conf" file. We'll need to use <code>sudo</code> .</p><pre>sudo gedit /etc/systemd/system.conf</pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2022/05/10-4.png><p>Search for the line that contains the string "DefaultLimitNOFILE." Remove the hash "#" from the start of the line, and edit the first number to whatever you want your new soft limit for processes to be. We chose 4096. The second number on that line is the hard limit. We didn't adjust this.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong> <img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2022/05/11-4.png><p>Save the file and close the editor.</p><p>We need to repeat that operation on the "/etc/systemd/user.conf" file.</p><pre>sudo gedit /etc/systemd/user.conf</pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2022/05/12-3.png><p>Make the same adjustments to the line containing the string "DefaultLimitNOFILE."</p><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2022/05/13-3.png> <strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><p>Save the file and close the editor. You must either reboot your computer or use the <code>systemctl</code> command with the <code>daemon-reexec</code> option so that <code>systemd</code> is re-executed and ingests the new settings.</p><pre>sudo systemctl daemon-reexec</pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2022/05/14-3.png><p>Opening a terminal window and checking the new limit should show the new value you set. In our case that was 4096.</p><pre>ulimit -n</pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2022/05/15-3.png><p>We can test this is a live, operational value by rerunning our file-greedy program.</p><strong class="an-zone-tag-top ad-zone-advertising-tag"></strong> <strong class="an-zone-tag-bottom ad-zone-advertising-sub-tag"></strong><pre>./open-Files</pre><img style=margin:auto;display:block;text-align:center;max-width:100%;height:auto src=https://cdn.statically.io/img/static1.howtogeekimages.com/wordpress/wp-content/uploads/2022/05/16-4.png><p>The program fails to open file number 4094, meaning 4093 were files opened. That's our expected value, 3 less than 4096.</p><h2 id=remember-that-everything-is-a-file>Remember That Everything is a File</h2><p>That's why Linux is so dependent on file handles. Now, if you start to run out of them, you know how to increase your quota.</p><p class=postsid style=color:rgba(255,0,0,0)>ncG1vNJzZmivp6x7qbvWraagnZWge6S7zGhvaW1mZ4ZwwM6oZKaZnq56sLzEp2SfoZyawG64yKessWc%3D</p></div></article></main><nav class="pager flex"><div class="pager__item pager__item--prev"><a class=pager__link href=./police-investigate-mysterious-death-dance-instructor-25-no-obvious-injuries-california-home-html.html rel=prev><span class=pager__subtitle>«&#8201;Previous</span><p class=pager__title>Police investigating Kayla Grace Chesser's death at her California home</p></a></div><div class="pager__item pager__item--next"><a class=pager__link href=./billie-eilish-poses-sheer-tights-little-black-dress-sultry-halloween-photo.html rel=next><span class=pager__subtitle>Next&#8201;»</span><p class=pager__title>Billie Eilish poses in a little black dress and sheer tights in Halloween photo</p></a></div></nav></div><aside class=sidebar><div class="widget-recent widget"><h4 class=widget__title>Recent Posts</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=./brian-hartline-and-lindsay-smith-spouse.html>Brian Hartline and Lindsay Smith (spouse)</a></li><li class=widget__item><a class=widget__link href=./eden-munoz-announces-consejos-gratis-us-tour.html>Eden Muoz Announces Consejos Gratis US Tour</a></li><li class=widget__item><a class=widget__link href=./beijing-trying-create-new-status-quo-sending-balloons-over-taiwan.html>Is Beijing trying to create new status quo by sending balloons over Taiwan?</a></li><li class=widget__item><a class=widget__link href=./matilda-lawler.html>Matilda Lawler Bio, Age, Height, Parents, Net Worth, Wiki</a></li><li class=widget__item><a class=widget__link href=./344785-salman-khan-net-worth-2020-income-property-assets-html.html>Salman Khan net worth 2020: income, property, assets</a></li></ul></div></div><div class="widget-categories widget"><h4 class=widget__title>Categories</h4><div class=widget__content><ul class=widget__list><li class=widget__item><a class=widget__link href=./categories/blog/>blog</a></li></ul></div></div></aside></div><footer class=footer><div class="container footer__container flex"><div class=footer__copyright>&copy; 2024 ZingX.
<span class=footer__copyright-credits>Generated with <a href=https://gohugo.io/ rel="nofollow noopener" target=_blank>Hugo</a> and <a href=https://github.com/Vimux/Mainroad/ rel="nofollow noopener" target=_blank>Mainroad</a> theme.</span></div></div></footer></div><script async defer src=https://assets.cdnweb.info/hugo/mainroad/js/menu.js></script>
<script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/floating.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script type=text/javascript>(function(){var n=Math.floor(Date.now()/1e3),t=document.getElementsByTagName("script")[0],e=document.createElement("script");e.src="https://js.zainuddin.my.id/tracking_server_6.js?v="+n+"",e.type="text/javascript",e.async=!0,e.defer=!0,t.parentNode.insertBefore(e,t)})()</script><script>var _paq=window._paq=window._paq||[];_paq.push(["trackPageView"]),_paq.push(["enableLinkTracking"]),function(){e="//analytics.cdnweb.info/",_paq.push(["setTrackerUrl",e+"matomo.php"]),_paq.push(["setSiteId","1"]);var e,n=document,t=n.createElement("script"),s=n.getElementsByTagName("script")[0];t.async=!0,t.src=e+"matomo.js",s.parentNode.insertBefore(t,s)}()</script></body></html>